{% extends "resources/base.twig" %}

{% block links %}
    <link rel="stylesheet" type="text/css" href="/static/css/reset.css"/>
    <link rel="stylesheet" type="text/css" href="/static/css/fonts.css"/>
    <link rel="stylesheet/less" type="text/css" href="/static/less/order-receipt.less"/>
    <script type="text/javascript">
        less = {
            env: "development", // or "production"
            async: false,       // load imports async
            fileAsync: false   // load imports async when in a page under
        };
    </script>
    <script src="/static/js/less-1.3.3.min.js" type="text/javascript"></script>
{% endblock %}

{% block page %}
    <h1>{% trans "Accuse de reception de commande" %}</h1>

    <div id="delivery">
        <h2>{% trans "Livraison" %}</h2>

        <p>{{ delivery.recipient }}</p>

        <p>{{ delivery.contact_name }}</p>

        <p> {{ delivery.address.line1 }}<br/>
            {% if delivery.address.line2 is not empty %}{{ delivery.address.line2 }}<br/>{% endif %}
            {% if delivery.address.line3 is not empty %}{{ delivery.address.line3 }}<br/>{% endif %}
            {{ delivery.address.post_code }}
            {{ delivery.address.city }}</p>

        <p>{{ delivery.country }}</p>

        <blockquote>
            {{ delivery.comments }}
        </blockquote>
    </div>
    <div id="client">
        <h2>{% trans "Client" %}</h2>
        <dl class="details">
            <dt>{% trans "Raison Sociale" %}</dt>
            <dd>{{ client.company_name }}</dd>
            <dt>{% trans "Contact" %}</dt>
            <dd>
                {% set fullname = [client.contact_forename, ' ', client.contact_name]|join %}

                {% if client.civility == 1 %}
                    {% trans "Mr" %}
                {% elseif client.civility == 2 %}
                    {% trans "Mme" %}
                {% elseif client.civility == 3 %}
                    {% trans "Mlle" %}
                {% elseif client.activity != 0 %}
                    {{ client.civility }}
                {% endif %}

                {% if client.contact_forename|capitalize not in client.contact_name|capitalize %}
                    {{ fullname }}
                {% else %}
                    {{ client.contact_name }}
                {% endif %}
            </dd>
            {% if client.id_tva %}
                <dt>{% trans "Numero TVA" %}</dt>
                <dd>{{ client.id_tva }}</dd>
            {% endif %}
        </dl>
    </div>
    <hr/>
    <div id="product">
        <h2>{% trans "Produit" %}</h2>

        <h3>{{ product.family }} {{ product.subfamily }} {{ product.name }}</h3>
        <dl id="product-options">
            {% for i, option in product.options %}
                <dt>{{ option.label }}</dt>
                <dd>{{ option.value }} <em>{{ option.unit }}</em></dd>
            {% endfor %}
        </dl>
    </div>

    <div id="order">
        <h2>{% trans "Commande" %}</h2>
        <dl>
            <dt>{% trans "Numero de commande" %}</dt>
            <dd>{{ order.id }}</dd>

            {% if order.devis_id %}
                <dt>{% trans "Numero de devis" %}</dt>
                <dd>{{ order.devis_id }}</dd>
            {% endif %}

            <dt>{% trans "Reference commande" %}</dt>
            <dd>{{ order.reference }}</dd>

            {% if order.devis_id %}
                <dt>{% trans "Reference devis" %}</dt>
                <dd>{{ order.devis_reference }}</dd>
            {% endif %}

            <dt>{% trans "Date" %}</dt>
            <dd>{{ order.creation_date|date('d/m/Y') }}</dd>

            <dt>{% trans "Mode de reglement" %}</dt>
            <dd>{{ order.regulation }}</dd>

            {% if agent.id %}
                <dt>{% trans "Responsable du dossier" %}</dt>
                <dd>{{ agent.forename }} {{ agent.name }}</dd>
            {% endif %}
        </dl>

        <table>
            <thead>
            <tr>
                <th></th>
                <th>{% trans "Quantite" %}</th>
                <th>{% trans "HT" %}</th>
                <th>{% trans "TVA" %} <small>{{ project.tva|formatnumber }}%</small></th>
                <th>{% trans "TTC" %}</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td>{% trans "Produit" %}</td>
                <td class="number">{{ order.quantity }} {{ order.unit.abbr }}</td>
                <td class="money">{{ product.et_amount|formatmoney }}</td>
                <td class="money">{{ product.vat_amount|formatmoney }}</td>
                <td class="money">{{ product.ati_amount|formatmoney }}</td>
            </tr>
            {% for i, fee in order.fees %}
                {% if fee.id %}
                    <tr>
                        <td>{{ fee.type }}</td>
                        <td class="number">{{ fee.quantity }}</td>
                        <td class="money">{{ fee.et_amount|formatmoney }}</td>
                        <td class="money">{{ fee.vat_amount|formatmoney }}</td>
                        <td class="money">{{ fee.ati_amount|formatmoney }}</td>
                    </tr>
                {% endif %}
            {% endfor %}
            <tr class="bold theme-color">
                <td>{% trans "Total" %}</td>
                <td></td>
                <td class="money">{{ project.et_amount|formatmoney }}</td>
                <td class="money">{{ project.vat_amount|formatmoney }}</td>
                <td class="money">
                    <strong>{{ project.ati_amount|formatmoney }}</strong>
                </td>
            </tr>
            </tbody>
        </table>

        <dl>
            <dt>{% trans "Solde" %}</dt>
            <dd>{{ order.balance|formatmoney }}</dd>
        </dl>

        <hr>
        <div id="mentions">
            <p>Si une de ces indications ne vous parait pas correcte, merci de nous le signaler le plus rapidement possible à l'adresse suivante : <a href="commande@exaprint.fr">commande@exaprint.fr</a>
                Les commandes sont validées par le pôle Administrations des Ventes jusqu'à18H chaque jour ouvré. Après cet horaire elles sont enregistrées le jour ouvré suivant.
                Notre délai catalogue court à compter de la réception de votre règlement et de votre fichier ou à compter de la validation de votre bon à tirer si vous avez opté
                pour cette option. Si une anomalie fichier vous est notifiée par le pôle PAO, le délai courra à compter de la date du déblocage de votre fichier.

            <p>Pour suivre l'avancée de votre commande, vous pouvez vous connecter sur notre site extranet onglet « suivi ».
                Nos conditions générales de vente sont consultables en ligne à l’adresse : www.exaprint.fr
                Important : La loi de Juillet 1881 oblige la présence du nom du prestataire technique ou de l'annonceur sur tous les documents destinés
                à être distribués sur la voie publique. Nous vous invitons donc à ajouter systématiquement le nom ou n° de RCS de votre entreprise (en votre qualité de revendeur,
                vous êtes considéré comme l'imprimeur du document) ou celui de votre client en petit sur l'ensemble de vos travaux. Attention, l'absence de cette mention obligatoire
                peut entraîner des sanctions financières et/ou pénales.</p>
        </div>
    </div>
{% endblock %}